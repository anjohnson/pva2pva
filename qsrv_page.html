<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>pva2pva: QSRV</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">pva2pva
   &#160;<span id="projectnumber">1.0.1-DEV</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">QSRV </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="qsrv_config"></a>
QSRV Configuration</h1>
<p>By default QSRV exposes all Process Variables (fields of process database records). In addition to these "single" PVs are special "group" PVs.</p>
<h2><a class="anchor" id="qsrv_single"></a>
Single PVs</h2>
<p>"single" PVs are the same set of names server by the Channel Access server (RSRV). This is all accessible record fields. So all data which is accessible via Channel Access is also accessible via PVAccess.</p>
<p>QSRV presents all "single" PVs as Structures conforming to the Normative Types NTScalar, NTScalarArray, or NTEnum depending on the native DBF field type.</p>
<h2><a class="anchor" id="qsrv_group_def"></a>
Group PV definitions</h2>
<p>A group is defined using a JSON syntax. Groups are defined with respect to a Group Name, which is also the PV name. So unlike records, the "field" of a group have a different meaning. Group field names are <em>not</em> part of the PV name.</p>
<p>A group definition is split among several records. For example of a group including two records is:</p>
<div class="fragment"><div class="line">record(ai, <span class="stringliteral">&quot;rec:X&quot;</span>) {</div><div class="line">  info(Q:group, {</div><div class="line">    <span class="stringliteral">&quot;grp:name&quot;</span>: {</div><div class="line">        <span class="stringliteral">&quot;X&quot;</span>: {+channel:<span class="stringliteral">&quot;VAL&quot;</span>}</div><div class="line">    }</div><div class="line">  })</div><div class="line">}</div><div class="line">record(ai, <span class="stringliteral">&quot;rec:Y&quot;</span>) {</div><div class="line">  info(Q:group, {</div><div class="line">    <span class="stringliteral">&quot;grp:name&quot;</span>: {</div><div class="line">        <span class="stringliteral">&quot;Y&quot;</span>: {+channel:<span class="stringliteral">&quot;VAL&quot;</span>}</div><div class="line">    }</div><div class="line">  })</div><div class="line">}</div></div><!-- fragment --><p>This group, named "grp:name", has two fields "X" and "Y".</p>
<div class="fragment"><div class="line">$ pvget grp:name</div><div class="line">grp:name</div><div class="line">structure </div><div class="line">    epics:nt/NTScalar:1.0 X</div><div class="line">        <span class="keywordtype">double</span> value 0</div><div class="line">        alarm_t alarm INVALID DRIVER UDF</div><div class="line">        time_t timeStamp &lt;undefined&gt; 0</div><div class="line">...</div><div class="line">    epics:nt/NTScalar:1.0 Y</div><div class="line">        <span class="keywordtype">double</span> value 0</div><div class="line">        alarm_t alarm INVALID DRIVER UDF</div><div class="line">        time_t timeStamp &lt;undefined&gt; 0</div><div class="line">...</div></div><!-- fragment --><h2><a class="anchor" id="qsrv_group_ref"></a>
Group PV reference</h2>
<div class="fragment"><div class="line">record(...) {</div><div class="line">    info(Q:group, {</div><div class="line">        <span class="stringliteral">&quot;&lt;group_name&gt;&quot;</span>:{</div><div class="line">            +id:<span class="stringliteral">&quot;some/NT:1.0&quot;</span>,  # top level ID</div><div class="line">            +meta:<span class="stringliteral">&quot;FLD&quot;</span>,        # map top level alarm/timeStamp</div><div class="line">            +atomic:<span class="keyword">true</span>,       # whether monitors <span class="keywordflow">default</span> to multi-locking atomicity</div><div class="line">            <span class="stringliteral">&quot;&lt;field.name&gt;&quot;</span>:{</div><div class="line">                +type:<span class="stringliteral">&quot;scalar&quot;</span>, # controls how map VAL mapped onto &lt;field.name&gt;</div><div class="line">                +channel:<span class="stringliteral">&quot;VAL&quot;</span>,</div><div class="line">                +id:<span class="stringliteral">&quot;some/NT:1.0&quot;</span>,</div><div class="line">                +trigger:<span class="stringliteral">&quot;*&quot;</span>,   # <span class="stringliteral">&quot;*&quot;</span> or comma seperated list of &lt;field.name&gt;s</div><div class="line">                +putorder:0,    # <span class="keyword">set</span> <span class="keywordflow">for</span> fields where put is allowed, processing done in increasing order</div><div class="line">            }</div><div class="line">        }</div><div class="line">    })</div><div class="line">}</div></div><!-- fragment --><h3><a class="anchor" id="qsrv_group_map_types"></a>
Field mapping types</h3>
<ul>
<li>"scalar" or "" </li>
<li>"plain" </li>
<li>"any" </li>
<li>"meta"</li>
</ul>
<p>The "scalar" mapping places an NTScalar or NTScalarArray as a sub-structure.</p>
<p>The "plain" mapping ignores all meta-data and places only the "value" as a field. The "value" is equivalent to '.value' of the equivalent NTScalar/NTScalarArray as a field.</p>
<p>The "any" mapping places a variant union into which the "value" is placed.</p>
<p>The "meta" mapping ignores the "value" and places only the alarm and time meta-data as sub-fields. The special group level tag 'meta:""' allows these meta-data fields to be placed in the top-level structure.</p>
<h3><a class="anchor" id="qsrv_group_map_trig"></a>
Field Update Triggers</h3>
<p>The field triggers define how changes to the consitutent field are translated into a subscription update to the group.</p>
<p>The most use of these are "" which means that changes to the field are ignored, and do not result group update. And "*" which results in a group update containing the most recent values/meta-data of all fields.</p>
<p>It may be useful to specify a comma seperated list of field names so that changes may partially update the group. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
